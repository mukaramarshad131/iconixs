import{aG as r,aa as t,aL as e,aM as a,ab as n,aF as o,ae as u,aN as i,aO as s,ac as c,aP as l,aQ as d,aR as v,ad as f}from"./index-a09fe141.js";import{u as b,v as p,D as h}from"./query-8c0888dc.js";var y=!1,g=a.useSyncExternalStore||function(a,n,o){var u=n();!1===globalThis.__DEV__||y||u===n()||(y=!0,!1!==globalThis.__DEV__&&r.error(60));var i=t.useState({inst:{value:u,getSnapshot:n}}),s=i[0].inst,c=i[1];return e?t.useLayoutEffect((function(){Object.assign(s,{value:u,getSnapshot:n}),P(s)&&c({inst:s})}),[a,u,n]):Object.assign(s,{value:u,getSnapshot:n}),t.useEffect((function(){return P(s)&&c({inst:s}),a((function(){P(s)&&c({inst:s})}))}),[a]),u};function P(r){var t=r.value,e=r.getSnapshot;try{return t!==e()}catch(a){return!0}}var S=Symbol.for("apollo.hook.wrappers");var w=Object.prototype.hasOwnProperty;function k(){}var O=Symbol();function D(r,t){return void 0===t&&(t=Object.create(null)),(e="useQuery",a=m,n=b(t&&t.client),o=n.queryManager,u=o&&o[S],(i=u&&u[e])?i(a):a)(r,t);var e,a,n,o,u,i}function m(r,e){var a=function(r,e){var a=b(e.client),s=t.useContext(o()).renderPromises,c=!!s,l=a.disableNetworkFetches,v=!1!==e.ssr&&!e.skip,f=e.partialRefetch,y=function(r,t,e,a){void 0===e&&(e={});var n=e.skip;e.ssr,e.onCompleted,e.onError;var o=e.defaultOptions,u=i(e,["skip","ssr","onCompleted","onError","defaultOptions"]);return function(e){var i=Object.assign(u,{query:t});return!a||"network-only"!==i.fetchPolicy&&"cache-and-network"!==i.fetchPolicy||(i.fetchPolicy="cache-first"),i.variables||(i.variables={}),n?(i.initialFetchPolicy=i.initialFetchPolicy||i.fetchPolicy||j(o,r.defaultOptions),i.fetchPolicy="standby"):i.fetchPolicy||(i.fetchPolicy=(null==e?void 0:e.options.initialFetchPolicy)||j(o,r.defaultOptions)),i}}(a,r,e,c),P=function(r,e,a,o,u){function i(t){var n;return p(e,h.Query),{client:r,query:e,observable:o&&o.getSSRObservable(u())||r.watchQuery(E(void 0,r,a,u())),resultData:{previousData:null===(n=null==t?void 0:t.resultData.current)||void 0===n?void 0:n.data}}}var s=t.useState(i),c=s[0],l=s[1];function d(r){var t,e;Object.assign(c.observable,((t={})[O]=r,t));var a=c.resultData;l(n(n({},c),{query:r.query,resultData:Object.assign(a,{previousData:(null===(e=a.current)||void 0===e?void 0:e.data)||a.previousData,current:void 0})}))}if(r!==c.client||e!==c.query){var v=i(c);return l(v),[v,d]}return[c,d]}(a,r,e,s,y),S=P[0],D=S.observable,m=S.resultData,q=P[1],F=y(D);!function(r,t,e,a,n){var o;t[O]&&!u(t[O],n)&&(t.reobserve(E(t,e,a,n)),r.previousData=(null===(o=r.current)||void 0===o?void 0:o.data)||r.previousData,r.current=void 0);t[O]=n}(m,D,a,e,F);var T=t.useMemo((function(){return function(r){return{refetch:r.refetch.bind(r),reobserve:r.reobserve.bind(r),fetchMore:r.fetchMore.bind(r),updateQuery:r.updateQuery.bind(r),startPolling:r.startPolling.bind(r),stopPolling:r.stopPolling.bind(r),subscribeToMore:r.subscribeToMore.bind(r)}}(D)}),[D]);!function(r,t,e){t&&e&&(t.registerSSRObservable(r),r.getCurrentResult().loading&&t.addObservableQueryPromise(r))}(D,s,v);var x=function(r,e,a,n,o,i,s,c,l){var v=t.useRef(l);t.useEffect((function(){v.current=l}));var f=!c&&!i||!1!==n.ssr||n.skip?n.skip||"standby"===o.fetchPolicy?R:void 0:M,b=r.previousData,p=t.useMemo((function(){return f&&C(f,b,e,a)}),[a,e,f,b]);return g(t.useCallback((function(t){if(c)return function(){};var n=function(){var n=r.current,o=e.getCurrentResult();n&&n.loading===o.loading&&n.networkStatus===o.networkStatus&&u(n.data,o.data)||Q(o,r,e,a,s,t,v.current)},o=function(c){if(i.current.unsubscribe(),i.current=e.resubscribeAfterError(n,o),!w.call(c,"graphQLErrors"))throw c;var l=r.current;(!l||l&&l.loading||!u(c,l.error))&&Q({data:l&&l.data,error:c,loading:!1,networkStatus:d.error},r,e,a,s,t,v.current)},i={current:e.subscribe(n,o)};return function(){setTimeout((function(){return i.current.unsubscribe()}))}}),[i,c,e,r,s,a]),(function(){return p||_(r,e,v.current,s,a)}),(function(){return p||_(r,e,v.current,s,a)}))}(m,D,a,e,F,l,f,c,{onCompleted:e.onCompleted||k,onError:e.onError||k});return{result:x,obsQueryFields:T,observable:D,resultData:m,client:a,onQueryExecuted:q}}(r,e),s=a.result,c=a.obsQueryFields;return t.useMemo((function(){return n(n({},s),c)}),[s,c])}function E(r,t,e,a){var n=[],o=t.defaultOptions.watchQuery;return o&&n.push(o),e.defaultOptions&&n.push(e.defaultOptions),n.push(s(r&&r.options,a)),n.reduce(c)}function Q(t,e,a,o,u,i,s){var c=e.current;c&&c.data&&(e.previousData=c.data),!t.error&&v(t.errors)&&(t.error=new f({graphQLErrors:t.errors})),e.current=C(function(r,t,e){if(r.partial&&e&&!r.loading&&(!r.data||0===Object.keys(r.data).length)&&"cache-only"!==t.options.fetchPolicy)return t.refetch(),n(n({},r),{loading:!0,networkStatus:d.refetch});return r}(t,a,u),e.previousData,a,o),i(),function(t,e,a){if(!t.loading){var n=function(r){return v(r.errors)?new f({graphQLErrors:r.errors}):r.error}(t);Promise.resolve().then((function(){n?a.onError(n):t.data&&e!==t.networkStatus&&t.networkStatus===d.ready&&a.onCompleted(t.data)})).catch((function(t){!1!==globalThis.__DEV__&&r.warn(t)}))}}(t,null==c?void 0:c.networkStatus,s)}function _(r,t,e,a,n){return r.current||Q(t.getCurrentResult(),r,t,n,a,(function(){}),e),r.current}function j(r,t){var e;return(null==r?void 0:r.fetchPolicy)||(null===(e=null==t?void 0:t.watchQuery)||void 0===e?void 0:e.fetchPolicy)||"cache-first"}function C(r,t,e,a){var o=r.data;r.partial;var u=i(r,["data","partial"]);return n(n({data:o},u),{client:a,observable:e,variables:e.variables,called:r!==M&&r!==R,previousData:t})}var M=l({loading:!0,data:void 0,error:void 0,networkStatus:d.loading}),R=l({loading:!1,data:void 0,error:void 0,networkStatus:d.ready});export{D as u};
