import{bs as t,bt as s,bu as e,bv as i,bw as r,bx as n,r as o,by as u,j as a,C as h,T as c,B as l}from"./index-a09fe141.js";import{n as p,s as d}from"./utils-88b441a0.js";import{R as m,C as b}from"./row-ec866866.js";var x=class extends t{#t;#s=void 0;#e;#i;constructor(t,s){super(),this.#t=t,this.setOptions(s),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const i=this.options;this.options=this.#t.defaultMutationOptions(t),s(this.options,i)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),i?.mutationKey&&this.options.mutationKey&&e(i.mutationKey)!==e(this.options.mutationKey)?this.reset():"pending"===this.#e?.state.status&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(t){this.#r(),this.#n(t)}getCurrentResult(){return this.#s}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#r(),this.#n()}mutate(t,s){return this.#i=s,this.#e?.removeObserver(this),this.#e=this.#t.getMutationCache().build(this.#t,this.options),this.#e.addObserver(this),this.#e.execute(t)}#r(){const t=this.#e?.state??i();this.#s={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#n(t){r.batch((()=>{if(this.#i&&this.hasListeners()){const s=this.#s.variables,e=this.#s.context;"success"===t?.type?(this.#i.onSuccess?.(t.data,s,e),this.#i.onSettled?.(t.data,null,s,e)):"error"===t?.type&&(this.#i.onError?.(t.error,s,e),this.#i.onSettled?.(void 0,t.error,s,e))}this.listeners.forEach((t=>{t(this.#s)}))}))}};const M={mockTokenExpired:()=>u.post({url:"/user/tokenExpired"})};function O(){const t=function(t,s){const e=n(s),[i]=o.useState((()=>new x(e,t)));o.useEffect((()=>{i.setOptions(t)}),[i,t]);const u=o.useSyncExternalStore(o.useCallback((t=>i.subscribe(r.batchCalls(t))),[i]),(()=>i.getCurrentResult()),(()=>i.getCurrentResult())),a=o.useCallback(((t,s)=>{i.mutate(t,s).catch(p)}),[i]);if(u.error&&d(i.options.throwOnError,[u.error]))throw u.error;return{...u,mutate:a,mutateAsync:u.mutate}}({mutationFn:M.mockTokenExpired});return a.jsx(h,{children:a.jsxs(m,{gutter:[16,16],children:[a.jsx(b,{span:24,md:12,children:a.jsx(c.Text,{children:"Clicking a button to simulate a token expiration scenario."})}),a.jsx(b,{span:24,md:12,children:a.jsx(l,{type:"primary",onClick:()=>{t.mutate()},children:"Simulate Token Expired"})})]})})}export{O as default};
